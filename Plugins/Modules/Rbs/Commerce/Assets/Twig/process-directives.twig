{% block acceptTermsAndConditions %}
	<div class="col-sm-12">
		<p class="alert alert-warning" role="alert">
			{{ i18n('m.rbs.commerce.front.must_accept_terms_and_conditions', ['ucf']) }}
		</p>
		<a class="btn btn-primary pull-right" href="{{ functionURL('Rbs_Commerce_Cart') }}">
			{{ i18n('m.rbs.commerce.front.back_to_cart', ['ucf']) }}
		</a>
	</div>
{% endblock acceptTermsAndConditions %}

{% block invalidTaxBehavior %}
	<div class="col-sm-12">
		<p class="alert alert-warning" role="alert">
			{{ i18n('m.rbs.commerce.front.invalid_tax_behavior', ['ucf']) }}
		</p>
		<a class="btn btn-primary pull-right" href="{{ functionURL('Rbs_Commerce_Cart') }}">
			{{ i18n('m.rbs.commerce.front.back_to_cart', ['ucf']) }}
		</a>
	</div>
{% endblock invalidTaxBehavior %}

{% block processStructure %}
	<script type="text/ng-template" id="/rbsCommerceProcess.tpl">
		<div class="row" data-ng-show="cartData">
			<div class="col-sm-3">
				{% block processStructureMenu %}
					<ol class="nav nav-stacked nav-pills process-menu">
						<li>
							<a href="javascript:" data-rbs-anchor="cart">
								<span class="badge pull-right">{{ block('rbsGenericIconOk') }}</span>
								{{ i18n('m.rbs.commerce.front.process_step_cart', ['ucf']) }}
							</a>
						</li>
						<li>
							<a href="javascript:" data-rbs-anchor="identification">
								<span data-ng-show="isStepChecked('identification')" class="badge pull-right">
									{{ block('rbsGenericIconOk') }}
								</span>
								{{ i18n('m.rbs.commerce.front.process_step_identification', ['ucf']) }}
							</a>
						</li>
						<li data-ng-class="{'disabled': !isStepEnabled('shipping')}">
							<a href="javascript:" data-rbs-anchor="shipping">
								<span data-ng-show="isStepChecked('shipping')" class="badge pull-right">
									{{ block('rbsGenericIconOk') }}
								</span>
								{{ i18n('m.rbs.commerce.front.process_step_shipping', ['ucf']) }}
							</a>
						</li>
						<li data-ng-class="{'disabled': !isStepEnabled('payment')}">
							<a href="javascript:" data-rbs-anchor="payment">
								{{ i18n('m.rbs.commerce.front.process_step_payment', ['ucf']) }}
							</a>
						</li>
						<li class="disabled">
							<a href="javascript:">{{ i18n('m.rbs.commerce.front.process_step_confirmation', ['ucf']) }}</a>
						</li>
					</ol>
				{% endblock processStructureMenu %}
			</div>
			<div class="col-sm-9">
				{% block processStructureCartStep %}
					<div id="cart" data-rbs-commerce-cart-lines="" data-cart-data="cartData"></div>
				{% endblock processStructureCartStep %}

				{% block processStructureIdentificationStep %}
					<div class="vertical-if-animation" data-ng-if="isStepEnabled('identification')">
						<div class="vertical-if-animation-content">
							<hr />
							<div id="identification" class="clearfix" data-rbs-commerce-identification-step="" >
							</div>
						</div>
					</div>
				{% endblock processStructureIdentificationStep %}

				{% block processStructureShippingStep %}
					<div class="vertical-if-animation" data-ng-if="isStepEnabled('shipping')">
						<div class="vertical-if-animation-content">
							<hr />
							<div id="shipping" class="clearfix" data-rbs-commerce-shipping-step="">
							</div>
						</div>
					</div>
				{% endblock processStructureShippingStep %}

				{% block processStructurePaymentStep %}
					<div class="vertical-if-animation" data-ng-if="isStepEnabled('payment')">
						<div class="vertical-if-animation-content">
							<hr />
							<div id="payment" class="clearfix" data-rbs-commerce-payment-step="">
							</div>
						</div>
					</div>
				{% endblock processStructurePaymentStep %}
			</div>
		</div>
	</script>
{% endblock processStructure %}

{% block processCartLines %}
	<script type="text/ng-template" id="/rbsCommerceCartLines.tpl">
		<h2>{{ i18n('m.rbs.commerce.front.process_step_cart', ['ucf']) }}</h2>
		<div class="table-responsive">
			<table summary="{{ i18nAttr('m.rbs.commerce.front.cart_contents', ['ucf']) }}"
				class="table table-striped table-vertical-middle">
				<thead>
					<tr>
						<th>{{ i18n('m.rbs.commerce.front.line_product', ['ucf']) }}</th>
						<th>{{ i18n('m.rbs.commerce.front.line_quantity', ['ucf']) }}</th>
						<th data-ng-if="showPrices" colspan="2" class="text-right">
							{{ i18n('m.rbs.commerce.front.line_prices', ['ucf']) }}
						</th>
					</tr>
				</thead>
				<tbody data-role="cart-lines"></tbody>
			</table>
		</div>
		<p class="clearfix">
			<a class="btn btn-default pull-right" href="{{ functionURL('Rbs_Commerce_Cart') }}">
				{{ i18n('m.rbs.commerce.front.modify_cart', ['ucf']) }}
			</a>
		</p>
	</script>
{% endblock %}

{% block processLine %}
	<script type="text/ng-template" id="/rbsCommerceProcessLineDefault.tpl">
		<tr>
			<td>
				<ul class="list-unstyled" data-ng-class="{'no-bottom-margin': !line.options.axesInfo.length}">
					<li data-ng-bind="line.product.common.title"></li>
					<li data-ng-show="line.product.common.reference" data-ng-bind="line.product.common.reference"></li>
				</ul>
				<dl class="dl-inline-items no-bottom-margin" data-ng-if="line.options.axesInfo.length">
					<dt data-ng-repeat-start="(index, axisInfo) in line.options.axesInfo">(= axisInfo.name =)</dt>
					<dd data-ng-repeat-end="">(= axisInfo.value =)</dd>
				</dl>
			</td>
			<td>
				<span>(= line.quantity =)</span>
			</td>
			<td data-ng-if="showPrices" class="price text-right text-muted hidden-xs">
				<ul class="list-unstyled no-bottom-margin" data-ng-show="line.quantity != 1">
					<li data-ng-show="parameters.displayPricesWithoutTax && line.basedAmountWithoutTaxes">
						<del>(= line.quantity =) x (= line.unitBasedAmountWithoutTaxes | rbsFormatPrice:currencyCode =)
							<abbr class="tax-mode" title="{{ i18nAttr('m.rbs.catalog.front.without_tax') }}">
								{{ i18n('m.rbs.catalog.front.without_tax_abbr') }}
							</abbr>
						</del>
					</li>
					<li data-ng-show="parameters.displayPricesWithTax && line.basedAmountWithTaxes">
						<del>(= line.quantity =) x (= line.unitBasedAmountWithTaxes | rbsFormatPrice:currencyCode =)</del>
					</li>
					<li data-ng-show="parameters.displayPricesWithoutTax">
						(= quantity =) x (= line.unitAmountWithoutTaxes | rbsFormatPrice:currencyCode =)
						<abbr class="tax-mode" title="{{ i18nAttr('m.rbs.catalog.front.without_tax') }}">
							{{ i18n('m.rbs.catalog.front.without_tax_abbr') }}
						</abbr>
					</li>
					<li data-ng-show="parameters.displayPricesWithTax">
						(= line.quantity =) x (= line.unitAmountWithTaxes | rbsFormatPrice:currencyCode =)
					</li>
				</ul>
			</td>
			<td data-ng-if="showPrices" class="price main-price text-right">
				<ul class="list-unstyled no-bottom-margin">
					<li data-ng-show="parameters.displayPricesWithoutTax && line.basedAmountWithoutTaxes">
						<del>(= line.basedAmountWithoutTaxes | rbsFormatPrice:currencyCode =)
							<abbr class="tax-mode" title="{{ i18nAttr('m.rbs.catalog.front.without_tax') }}">
								{{ i18n('m.rbs.catalog.front.without_tax_abbr') }}
							</abbr>
						</del>
					</li>
					<li data-ng-show="parameters.displayPricesWithTax && line.basedAmountWithTaxes">
						<del>(= line.basedAmountWithTaxes | rbsFormatPrice:currencyCode =)</del>
					</li>
					<li data-ng-show="parameters.displayPricesWithoutTax">
						(= line.amountWithoutTaxes | rbsFormatPrice:currencyCode =)
						<abbr class="tax-mode" title="{{ i18nAttr('m.rbs.catalog.front.without_tax') }}">
							{{ i18n('m.rbs.catalog.front.without_tax_abbr') }}
						</abbr>
					</li>
					<li data-ng-show="parameters.displayPricesWithTax">
						(= line.amountWithTaxes | rbsFormatPrice:currencyCode =)
					</li>
				</ul>
			</td>
		</tr>
	</script>
{% endblock processLine %}

{% block processIdentificationStep %}
	<script type="text/ng-template" id="/rbsCommerceIdentificationStep.tpl">
		<h2 data-ng-hide="hideStepTitle">{{ i18n('m.rbs.commerce.front.process_step_identification', ['ucf']) }}</h2>
		<ul class="text-danger" data-ng-if="processData.errors.length">
			<li data-ng-repeat="error in processData.errors">(= error =)</li>
		</ul>
		<div class="row" data-ng-if="processData.isCurrent">
			<div class="col-sm-6" data-ng-if="!processData.userId" >
				<div class="panel panel-default">
					<div class="panel-heading">{{ i18n('m.rbs.commerce.front.already_customer', ['ucf']) }}</div>
					<div class="panel-body">
						<div class="form-group">
							<label for="rbs-order-process-login" class="control-label">
								{{ i18n('m.rbs.user.front.login', ['ucf']) }}
							</label>
							<input id="rbs-order-process-login" data-ng-model="processData.login"
								type="text" name="login" required="required" class="form-control"
								placeholder="{{ i18nAttr('m.rbs.user.front.login_placeholder', ['ucf']) }}" />
						</div>
						<div class="form-group">
							<label for="rbs-order-process-password" class="control-label">
								{{ i18n('m.rbs.user.front.password', ['ucf']) }}
							</label>
							<input id="rbs-order-process-password" data-ng-model="processData.password"
								type="password" name="password" required="required" class="form-control"
								placeholder="{{ i18nAttr('m.rbs.user.front.password_placeholder', ['ucf']) }}" />
						</div>
						<div class="form-group text-right" data-rbs-user-forgot-password=""></div>
						<button class="btn btn-primary" data-ng-disabled="!processData.login || !processData.password"
								data-ng-click="login()">
							{{ i18n('m.rbs.user.front.log_in', ['ucf']) }}
						</button>
					</div>
				</div>
			</div>
			<div class="col-sm-6" data-ng-if="processData.userId">
				<div class="panel panel-default">
					<div class="panel-heading">
						{{ i18n('m.rbs.commerce.front.are_you_really', ['ucf'], { 'NAME': "<strong>(= processData.email =)</strong>" })|raw }}
					</div>
					<div class="panel-body" data-ng-hide="processData.confirmed">
						<p>{{ i18n('m.rbs.commerce.front.please_log_in_again', ['ucf']) }}</p>
						<div data-ng-form="passwordConfirmForm">
							<div class="form-group">
								<label for="rbs-order-process-password">{{ i18n('m.rbs.user.front.password', ['ucf']) }}</label>
								<input id="rbs-order-process-password" data-ng-model="processData.password"
									type="password" name="password" required="required" class="form-control"
									placeholder="{{ i18nAttr('m.rbs.user.front.password_placeholder', ['ucf']) }}" />
							</div>
							<button class="btn btn-primary" data-ng-disabled="!processData.password" data-ng-click="login()">
								{{ i18n('m.rbs.user.front.log_in', ['ucf']) }}
							</button>
						</div>
					</div>
					<div class="panel-body" data-ng-show="processData.confirmed">
						<button class="btn btn-primary" data-ng-click="next()">
							{{ i18n('m.rbs.commerce.front.continue', ['ucf']) }}
						</button>
					</div>
				</div>
			</div>
			<div class="col-sm-6" data-ng-if="!processData.userId">
				<div class="panel panel-default">
					<div class="panel-heading">{{ i18n('m.rbs.commerce.front.new_customer', ['ucf']) }}</div>
					<div class="panel-body">
						<div data-ng-form="emailForm">
							<div class="form-group" data-ng-class="{
								'has-error': emailForm.email.$dirty && emailForm.email.$invalid,
								'has-success': emailForm.email.$dirty && !emailForm.email.$invalid
							}">
								<label for="rbs-order-process-email" class="control-label">
									{{ i18n('m.rbs.user.front.email', ['ucf']) }}
								</label>
								<input id="rbs-order-process-email" data-ng-model="processData.email"
									type="email" name="email" required="required" class="form-control"
									placeholder="{{ i18nAttr('m.rbs.user.front.email_placeholder', ['ucf']) }}" />
								<p class="text-danger" data-ng-show="emailForm.email.$dirty && emailForm.email.$invalid">
									{{ i18n('c.constraints.emailaddressinvalid', ['ucf']) }}
								</p>
							</div>
							<div class="form-group" data-ng-class="{
								'has-error': (emailForm.confirmEmail.$dirty && emailForm.confirmEmail.$invalid) || (!emailForm.$invalid && !canSetEmail()),
								'has-success': emailForm.confirmEmail.$dirty && !emailForm.confirmEmail.$invalid && canSetEmail()
							}">
								<label for="rbs-order-process-confirm-email" class="control-label">
									{{ i18n('m.rbs.user.front.confirm_email', ['ucf']) }}
								</label>
								<input id="rbs-order-process-confirm-email" data-ng-model="processData.confirmEmail"
									type="email" name="confirmEmail" required="required" class="form-control"
									placeholder="{{ i18nAttr('m.rbs.user.front.email_placeholder', ['ucf']) }}" />
								<p class="text-danger"
									data-ng-show="emailForm.confirmEmail.$dirty && emailForm.confirmEmail.$invalid">
									{{ i18n('c.constraints.emailaddressinvalid', ['ucf']) }}
								</p>
								<p class="text-danger" data-ng-show="!emailForm.$invalid && !canSetEmail()">
									{{ i18n('m.rbs.user.front.error_email_not_match_confirm_email', ['ucf']) }}
								</p>
							</div>
							<button class="btn btn-primary" data-ng-disabled="!canSetEmail()" data-ng-click="setEmail()">
								{{ i18n('m.rbs.commerce.front.continue', ['ucf']) }}
							</button>
						</div>
					</div>
				</div>
			</div>
			<div class="col-sm-6" data-ng-if="processData.userId">
				<div class="panel panel-default">
					<div class="panel-heading">
						{{ i18n('m.rbs.commerce.front.not_you', ['ucf'], { 'NAME': "<strong>(= processData.email =)</strong>" })|raw }}
					</div>
					<div class="panel-body">
						<p>{{ i18n('m.rbs.commerce.front.please_log_out', ['ucf']) }}</p>
						<a class="btn btn-primary" href="javascript:" data-ng-click="changeUser()">
							{{ i18n('m.rbs.commerce.front.change_user', ['ucf']) }}
						</a>
					</div>
				</div>
			</div>
		</div>
		<div class="row" data-ng-if="!processData.isCurrent">
			<div class="col-md-12">
				<address class="no-bottom-margin">
					<strong>(= processData.email =)</strong><br>
				</address>
				<div class="clearfix">
					<p>
						<button class="btn btn-default pull-right" data-ng-click="setCurrentStep()">
							{{ i18n('m.rbs.commerce.front.modify', ['ucf']) }}
						</button>
					</p>
				</div>
			</div>
		</div>
	</script>
{% endblock processIdentificationStep %}

{% block processShippingStep %}
	{% block processShippingStepModes %}
		<script type="text/ng-template" id="/rbsCommerceShippingStep.tpl">
			<h2 data-ng-hide="hideStepTitle">{{ i18n('m.rbs.commerce.front.process_step_shipping', ['ucf']) }}</h2>
			<div data-ng-if="processData.isCurrent">
				<ul class="text-danger" data-ng-if="processData.errors.length">
					<li data-ng-repeat="error in processData.errors">(= error =)</li>
				</ul>
				<div class="panel panel-default" data-ng-repeat="shippingModeData in processData.shippingModes track by $index">
					<div class="panel-heading" data-ng-show="processData.shippingModes.length > 1">
						{{ i18n('m.rbs.commerce.front.shipping_part_of', ['ucf'], {'NUMBER': "(= $index + 1 =)", 'TOTAL': "(= processData.shippingModes.length =)"}) }}
					</div>
					<div class="panel-body" data-ng-if="hasCategory('store')">
						<h3>{{ i18n('m.rbs.commerce.front.store_delivery', ['ucf']) }}</h3>
						<div data-rbs-commerce-shipping-other-step="" data-shipping-mode="shippingModeData"
							data-user-id="processData.userId" data-user-addresses="userAddresses"
							data-process-id="processData.processId"
							data-shipping-modes-info="shippingModesInfo.store"></div>
					</div>
					<div class="panel-body" data-ng-if="hasCategory('relay')">
						<h3>{{ i18n('m.rbs.commerce.front.relay_delivery', ['ucf']) }}</h3>
						<div data-rbs-commerce-shipping-other-step="" data-shipping-mode="shippingModeData"
							data-user-id="processData.userId" data-user-addresses="userAddresses"
							data-process-id="processData.processId"
							data-shipping-modes-info="shippingModesInfo.relay"></div>
					</div>
					<div class="panel-body" data-ng-if="hasCategory('atHome')">
						<h3>{{ i18n('m.rbs.commerce.front.at_home_delivery', ['ucf']) }}</h3>
						<div data-rbs-commerce-shipping-at-home-step="" data-shipping-mode="shippingModeData"
							data-user-id="processData.userId" data-user-addresses="userAddresses"
							data-process-id="processData.processId"
							data-shipping-modes-info="shippingModesInfo.atHome"></div>
					</div>
				</div>
				<button class="btn pull-right btn-primary" data-ng-click="next()" data-ng-disabled="!shippingModesValid()">
					{{ i18n('m.rbs.commerce.front.continue', ['ucf']) }}
				</button>
				<div class="clearfix"></div>
			</div>
			<div data-ng-if="!processData.isCurrent">
				<div class="panel panel-default" data-ng-repeat="shippingModeData in processData.shippingModes track by $index">
					<div class="panel-heading" data-ng-show="processData.shippingModes.length > 1">
						{{ i18n('m.rbs.commerce.front.shipping_part_of', ['ucf'], {'NUMBER': "(= $index + 1 =)", 'TOTAL': "(= processData.shippingModes.length =)"}) }}</div>
					<div class="panel-body" data-ng-if="isCategory(shippingModeData, 'store')">
						<h3>{{ i18n('m.rbs.commerce.front.store_delivery', ['ucf']) }}</h3>
						<div data-rbs-commerce-shipping-other-step="" data-summary="true"
							data-shipping-mode="shippingModeData"
							data-shipping-modes-info="shippingModesInfo.store"></div>
					</div>
					<div class="panel-body" data-ng-if="isCategory(shippingModeData, 'relay')">
						<h3>{{ i18n('m.rbs.commerce.front.relay_delivery', ['ucf']) }}</h3>
						<div data-rbs-commerce-shipping-other-step="" data-summary="true"
							data-shipping-mode="shippingModeData"
							data-shipping-modes-info="shippingModesInfo.relay"></div>
					</div>
					<div class="panel-body" data-ng-if="isCategory(shippingModeData, 'atHome')">
						<h3>{{ i18n('m.rbs.commerce.front.at_home_delivery', ['ucf']) }}</h3>
						<div data-rbs-commerce-summary-shipping-at-home-step=""
							data-shipping-mode="shippingModeData"
							data-shipping-modes-info="shippingModesInfo.atHome"></div>
					</div>
				</div>
				<div class="clearfix">
					<p>
						<button class="btn btn-default pull-right" data-ng-click="setCurrentStep()">
							{{ i18n('m.rbs.commerce.front.modify', ['ucf']) }}
						</button>
					</p>
				</div>
			</div>
		</script>
	{% endblock processShippingStepModes %}

	{% block rbsCommerceModeSelector %}
		<script type="text/ng-template" id="/rbsCommerceModeSelector.tpl">
			<img class="pull-right" data-ng-show="shippingModeInfo.presentation.visual"
				alt="(= shippingModeInfo.presentation.visual.alt =)"
				src="" data-ng-src="(= shippingModeInfo.presentation.visual.modeThumbnail =)" />
			<label>
				<input type="radio" data-ng-model="shippingMode.id" data-ng-value="shippingModeInfo.common.id" />
				(= shippingModeInfo.common.title =)
			</label>
			<div data-ng-show="showPrices">
				<span>{{ i18n('m.rbs.commerce.front.shipping_fee', ['ucf', 'lab']) }}</span>
					<span data-ng-show="showPrices.displayPricesWithoutTax && shippingModeInfo.fee.amountWithoutTaxes"
						class="price">
						(= shippingModeInfo.fee.amountWithoutTaxes | rbsFormatPrice:showPrices.currencyCode =)
						<abbr class="tax-mode" title="{{ i18nAttr('m.rbs.catalog.front.without_tax') }}">
							{{ i18n('m.rbs.catalog.front.without_tax_abbr') }}
						</abbr>
					</span>
					<span class="price" data-ng-show="showPrices.displayPricesWithTax && shippingModeInfo.fee.amountWithTaxes">
						(= shippingModeInfo.fee.amountWithTaxes | rbsFormatPrice:showPrices.currencyCode =)
					</span>
					<span class="price" data-ng-show="shippingModeInfo.fee.free">
						(= shippingModeInfo.fee.free =)
					</span>
			</div>
			<div class="small" data-ng-bind-html="trustHtml(shippingModeInfo.presentation.description)"></div>
			<div class="clearfix"></div>
		</script>
	{%  endblock rbsCommerceModeSelector %}

	{% block rbsCommerceSummaryShippingAtHomeStep %}
		<script type="text/ng-template" id="/rbsCommerceSummaryShippingAtHomeStep.tpl">
			<div class="row">
				<div class="col-md-4">
					<address class="no-bottom-margin" data-ng-show="shippingMode.address">
						<strong>(= shippingMode.address.lines[0] =)</strong>
						<div data-ng-repeat="addressLine in shippingMode.address.lines track by $index" data-ng-show="!$first">
							(= addressLine =)
						</div>
					</address>
				</div>
				<div class="col-md-8">
					<img class="pull-right" data-ng-show="shippingModeInfo.presentation.visual"
						alt="(= shippingModeInfo.presentation.visual.alt =)"
						src="" data-ng-src="(= shippingModeInfo.presentation.visual.modeThumbnail =)" >
					<label>
						(= shippingModeInfo.common.title =)
					</label>
					<div class="small" data-ng-bind-html="trustHtml(shippingModeInfo.presentation.description)"></div>
				</div>
			</div>
		</script>
	{% endblock rbsCommerceSummaryShippingAtHomeStep %}

	{% block rbsCommerceShippingAtHomeStep %}
		<script type="text/ng-template" id="/rbsCommerceShippingAtHomeStep.tpl">
			<div data-ng-hide="shippingMode.edition">
				<div class="row" data-ng-hide="isEmptyAddress(atHomeAddress)">
					<div class="col-md-4">
						<address class="no-bottom-margin">
							<strong>(= atHomeAddress.lines[0] =)</strong>
							<div data-ng-repeat="addressLine in atHomeAddress.lines track by $index" data-ng-show="!$first">
								(= addressLine =)
							</div>
						</address>
						<button class="btn btn-default" data-ng-click="editAddress()">
							{{ i18n('m.rbs.commerce.front.modify', ['ucf']) }}
						</button>
					</div>
					<div class="col-md-8">
						<div data-ng-show="!loadShippingModes && !shippingMode.allowedShippingModesInfo.length">
							{{ i18n('m.rbs.commerce.front.no_shipping_mode_available', ['ucf']) }}
						</div>
						<div data-ng-repeat="allowedShippingModeInfo in shippingMode.allowedShippingModesInfo track by $index">
							<div data-rbs-commerce-mode-selector="" data-show-prices="showPrices"
								data-shipping-mode="shippingMode" data-shipping-mode-info="allowedShippingModeInfo"></div>
						</div>
					</div>
				</div>
				<div class="row" data-ng-show="isEmptyAddress(atHomeAddress)">
					<div class="col-md-12">
						<div>
							{{ i18n('m.rbs.commerce.front.at_home_address_not_defined', ['ucf']) }}
						</div>
						<button class="btn btn-default" data-ng-click="editAddress()">
							{{ i18n('m.rbs.commerce.front.define_address', ['ucf']) }}
						</button>
					</div>
				</div>
			</div>
			<div data-ng-show="shippingMode.edition">
				<div data-ng-show="userAddresses.length" class="row">
					<div data-ng-repeat-start="address in userAddresses" class="col-md-6 col-lg-4">
						<h4>(= address.common.name =)</h4>
						<address>
							<strong>(= address.lines[0] =)</strong>
							<div data-ng-repeat="line in address.lines track by $index" data-ng-show="!$first">
								(= line =)
							</div>
						</address>
						<p>
							<button type="button" class="btn btn-sm btn-primary" data-ng-click="selectUserAddress(address)">
								{{ i18n('m.rbs.commerce.front.button_use_this_address', ['ucf']) }}
							</button>
						</p>
					</div>
					<div data-ng-if="($index % 3) == 2" class="clearfix visible-lg-block"></div>
					<div data-ng-repeat-end="" data-ng-if="($index % 2) == 1" class="clearfix visible-md-block"></div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<ul class="text-danger" data-ng-if="matchingZoneError">
							<li>(= matchingZoneError =)</li>
						</ul>
						<div data-rbs-geo-address-editor="" data-address="atHomeAddress"
							data-manage-name="(= userId ? 'optional' : 'none' =)"
							data-zone-code="shippingMode.shippingZone" data-valid="atHomeAddressIsValid">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-8 col-sm-offset-4 col-md-9 col-md-offset-3">
						<button type="button" class="btn btn-sm btn-primary" data-ng-click="useAddress()"
							data-ng-disabled="!atHomeAddressIsValid">
							{{ i18n('m.rbs.commerce.front.button_use_this_address', ['ucf']) }}
						</button>
					</div>
				</div>
			</div>
		</script>
	{% endblock rbsCommerceShippingAtHomeStep %}
{% endblock processShippingStep %}

{% block processPaymentStep %}
	<script type="text/ng-template" id="/rbsCommercePaymentStep.tpl">
		<h2 data-ng-hide="hideStepTitle">{{ i18n('m.rbs.commerce.front.process_step_payment', ['ucf']) }}</h2>
		<ul class="text-danger" data-ng-if="processData.errors.length">
			<li data-ng-repeat="error in processData.errors">(= error =)</li>
		</ul>

		<div class="panel panel-default">
			<div class="panel-heading">{{ i18n('m.rbs.commerce.front.coupons', ['ucf']) }}</div>
			<div class="panel-body form-horizontal">
				<div class="form-group" data-ng-if="processData.coupons.length > 0">
					<label class="col-sm-6 col-md-4 control-label">
						{{ i18n('m.rbs.commerce.front.applied_coupons', ['ucf']) }}
					</label>
					<div class="col-sm-6 col-md-8">
						<p class="form-control-static" data-ng-repeat="coupon in processData.coupons">
							(= coupon.code =)
							<span data-ng-if="coupon.title && (coupon.title != coupon.code)">((= coupon.title =))</span>
							<button class="btn btn-default btn-xs" data-ng-click="removeCoupon($index)"
								data-ng-if="!hasTransaction()" title="{{ i18n('m.rbs.commerce.front.remove', ['ucf', 'attr']) }}">
								{{ block('rbsGenericIconRemove') }}
							</button>
						</p>
					</div>
				</div>
				<div data-ng-if="!hasTransaction()" class="form-group no-bottom-margin">
					<label for="newCouponCode" class="col-sm-6 col-md-4 control-label">
						{{ i18n('m.rbs.commerce.front.add_code', ['ucf']) }}
					</label>
					<div class="col-sm-6 col-md-8">
						<div class="input-group">
							<input id="newCouponCode" type="text" class="form-control"
								data-ng-model="processData.newCouponCode" />
							<span class="input-group-btn">
								<button class="btn btn-primary" type="button" data-ng-click="addCoupon()"
									data-ng-disabled="processData.newCouponCode.length < 1">
									{{ block('rbsGenericIconOk') }}
									{{ i18n('m.rbs.commerce.front.ok', ['ucf']) }}
								</button>
							</span>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">{{ i18n('m.rbs.commerce.front.process_step_payment_title', ['ucf']) }}</div>
			<div class="panel-body" data-ng-if="!processData.addressEdition">
				<div class="row">
					<div class="col-md-4">
						<h3>{{ i18n('m.rbs.commerce.front.billing_address', ['ucf']) }}</h3>
						<address class="no-bottom-margin" data-ng-show="processData.address">
							<strong>(= processData.address.lines[0] =)</strong>
							<div data-ng-repeat="addressLine in processData.address.lines track by $index" data-ng-show="!$first">
								(= addressLine =)
							</div>
						</address>
						<button class="btn btn-default" data-ng-click="editAddress()" data-ng-if="!hasTransaction()">
							{{ i18n('m.rbs.commerce.front.modify', ['ucf']) }}
						</button>
					</div>
					<div class="col-md-8">
						<table summary="{{ i18nAttr('m.rbs.commerce.front.payment_amounts', ['ucf']) }}" class="table">
							<tbody class="text-right">
								<tr data-ng-if="linesProducts">
									<td>(= linesProducts =)
										<span data-ng-show="linesProducts == 1">{{ i18n('m.rbs.commerce.front.article') }}</span>
										<span data-ng-show="linesProducts > 1">{{ i18n('m.rbs.commerce.front.articles') }}</span>
									</td>
									<td>(= linesAmount =)</td>
								</tr>
								<tr data-ng-repeat="amountLine in amountLines">
									<td>(= amountLine.title =)</td>
									<td>(= amountLine.amount =)</td>
								</tr>
								<tr data-ng-if="taxesAmount" class="text-muted">
									<td>{{ i18n('m.rbs.commerce.front.payment_taxes', ['ucf']) }}</td>
									<td>(= taxesAmount =)</td>
								</tr>
								<tr data-ng-if="creditNotesAmount">
									<td>{{ i18n('m.rbs.commerce.front.credit_notes_total_amounts', ['ucf']) }}</td>
									<td>(= creditNotesAmount =)</td>
								</tr>
								<tr>
									<td><strong>{{ i18n('m.rbs.commerce.front.amount_to_pay', ['ucf']) }}</strong></td>
									<td class="price">(= paymentAmount =)</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="panel-body" data-ng-if="processData.addressEdition">
				<h3>{{ i18n('m.rbs.commerce.front.billing_address', ['ucf']) }}</h3>
				<div data-ng-show="userAddresses.length" class="row">
					<div data-ng-repeat-start="address in userAddresses" class="col-md-6 col-lg-4">
						<h4>(= address.common.name =)</h4>
						<address>
							<strong>(= address.lines[0] =)</strong>
							<div data-ng-repeat="line in address.lines track by $index" data-ng-show="!$first">
								(= line =)
							</div>
						</address>
						<p>
							<button type="button" class="btn btn-sm btn-primary"
									data-ng-click="selectUserAddress(address)" >
								{{ i18n('m.rbs.commerce.front.button_use_this_address', ['ucf']) }}
							</button>
						</p>
					</div>
					<div data-ng-if="($index % 3) == 2" class="clearfix visible-lg-block"></div>
					<div data-ng-repeat-end="" data-ng-if="($index % 2) == 1" class="clearfix visible-md-block"></div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div data-rbs-geo-address-editor="" data-address="processData.address"
								data-manage-name="(= processData.userId ? 'optional' : 'none' =)"
								data-accept-zones=""
								data-valid="processData.addressIsValid">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-8 col-sm-offset-4 col-md-9 col-md-offset-3">
						<button type="button" class="btn btn-sm btn-primary" data-ng-click="useAddress()"
							data-ng-disabled="!processData.addressIsValid">
							{{ i18n('m.rbs.commerce.front.button_use_this_address', ['ucf']) }}
						</button>
					</div>
				</div>
			</div>
		</div>

		<div class="text-right">
			<p data-ng-if="!hasTransaction()">
				<button class="btn btn-lg btn-primary" type="button" data-ng-click="savePayment()"
					data-ng-disabled="isEmptyAddress(processData.address) || processData.addressEdition">
					{{ i18n('m.rbs.commerce.front.continue', ['ucf']) }}
				</button>
			</p>
			<p data-ng-if="hasTransaction()">
				<button class="btn btn-default" type="button" data-ng-click="modify()">
					{{ i18n('m.rbs.commerce.front.modify', ['ucf']) }}
				</button>
			</p>
		</div>

		<div data-ng-if="hasTransaction()">
			<div class="panel panel-default" data-ng-if="paymentConnectorsInfo.length">
				<div class="panel-heading">{{ i18n('m.rbs.commerce.front.payment_connector', ['ucf']) }}</div>
				<div class="panel-body">
					{{ i18n('m.rbs.commerce.front.select_payment_connector', ['ucf']) }}
				</div>
				<div class="list-group">
					<a data-ng-repeat="(index, connector) in paymentConnectorsInfo" href="javascript:" class="list-group-item"
						data-ng-class="{active: connector.common.id == processData.id}" data-ng-click="selectConnector(index)">
						<div class="row">
							<div class="col-sm-7 col-md-8 col-lg-9">
								<input type="radio" data-ng-checked="connector.common.id == processData.id" />
								(= connector.common.title =)<br />
								<div class="small" data-ng-bind-html="trustHtml(connector.presentation.description)"></div>
							</div>
							<div class="col-sm-5 col-md-4 col-lg-3">
								<img data-ng-show="connector.presentation.visual" alt="(= connector.presentation.visual.alt =)"
									src="" data-ng-src="(= connector.presentation.visual.modeThumbnail =)" />
							</div>
						</div>
					</a>
				</div>
			</div>
			<div data-role="connector-configuration-zone"></div>
		</div>
	</script>
{% endblock processPaymentStep %}

